# 2. Постановка задачи
1. Серверный компонент системы управления и исполнения параметрированными функциями:
- Система оперирует основным типом объекта - параметрированной функцией вещественных переменных y = f(x, λ)
- Объектами функции f(⋅, λ) можно управлять (создание, обновление, запрос, удаление) - CRUD
- Можно запрашивать вычисление функций на входных параметрах x
- Запрос функции позволяет получить ее имя, сигнатуру входа, сигнатуры выхода, набор параметров
- Система предоставляет два интерфейса:
    - асинхронный HTTP RESTful API
    - CLI
2. Примеры клиентских приложений, обращающихся к системе через API и через CLI
Мотивация: предложенная задача - прообраз MLOps системы и inference server'а, где модели МО заменены функциями, а операция обучения заменена на обновление функции.

# Структура проекта
models.py        - Модели данных (Pydantic)
storage.py       - Хранилище функций в памяти
server.py        - HTTP-сервер (FastAPI), бизнес-логика и модели данных
cli.py           - CLI-клиент для работы с сервером
requirements.txt - Зависимости проекта

## Назначение файлов

### models.py
Модуль описания моделей данных.
Содержит:
- описание моделей данных с использованием Pydantic:
  - `Function` — модель параметризованной функции;
  - `UpdateRequest` — модель запроса обновления функции;
  - `ExecuteRequest` — модель запроса вычисления функции;
Модуль не содержит бизнес-логики и используется как общий слой данных для сервера и хранилища.

### server.py

Основной модуль сервера.

Содержит:
- реализацию HTTP API с использованием FastAPI;
- бизнес-логику создания, обновления, удаления и вычисления функций;
- обработку ошибок и формирование HTTP-ответов.
Модели данных импортируются из модуля models.py.

### storage.py

Модуль хранения данных.

Содержит глобальное хранилище функций, реализованное в виде словаря.
Хранилище используется сервером для хранения всех созданных функций
на время работы приложения.

### cli.py

CLI-клиент для взаимодействия с сервером.

Позволяет:
- получать список функций;
- получать описание функции;
- создавать новые функции;
- вычислять значение функции по заданным входным данным.

CLI взаимодействует с сервером исключительно через HTTP API.



# Установка и запуск

## Linux / macOS
```bash
python -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
```

## Windows (PowerShell)
```powershell
py -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install --upgrade pip
```

## Установка зависимостей
Проект использует следующие внешние библиотеки:
- fastapi — фреймворк для создания HTTP API;
- uvicorn — ASGI-сервер для запуска FastAPI;
- pydantic — валидация и сериализация данных;
- requests — HTTP-клиент для работы CLI.
Установка всех зависимостей выполняется командой:
```powershell
pip install -r requirements.txt
```

## Запуск

### Запуск сервера
Для запуска сервера используется uvicorn.

```bash
uvicorn server:app --reload
```
После запуска сервер будет доступен по адресу: http://localhost:8000
Автоматически будет доступна интерактивная документация API (Swagger): http://localhost:8000/docs

### Запуск и использование CLI-клиента
CLI-клиент запускается в **отдельном терминале**, при запущенном сервере.

Получение списка функций
```powershell
python cli.py list
```

Создание новой функции
```powershell
python cli.py create linear --inputs x --outputs y --params a=2 b=1 --expr "a*x+b"
```

Получение описания функции
```powershell
python cli.py get linear
```

Вычисление значения функции
```powershell
python cli.py exec linear --x 3
```

## Общая схема работы
1. Пользователь запускает сервер.
2. Сервер принимает HTTP-запросы и управляет функциями.
3. CLI-клиент отправляет запросы к серверу через HTTP API.
4. Все функции хранятся в памяти сервера на время его работы.
